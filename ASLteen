<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ASL STEM Game</title>

<script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:linear-gradient(135deg,#0ea5e9,#14b8a6);
  color:white;
  text-align:center;
}

header{
  padding:15px;
}

#mascot{
  position:fixed;
  top:10px;
  left:10px;
  font-size:50px;
}

.stats{
  margin-top:5px;
}

.level-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(90px,1fr));
  gap:10px;
  padding:20px;
}

.level{
  background:white;
  color:black;
  padding:12px;
  border-radius:12px;
  cursor:pointer;
  font-weight:bold;
}

.locked{
  opacity:0.4;
  cursor:not-allowed;
}

.lesson{
  display:none;
  background:white;
  color:black;
  margin:20px;
  padding:20px;
  border-radius:15px;
}

button{
  padding:10px 15px;
  border:none;
  border-radius:10px;
  background:#ef4444;
  color:white;
  cursor:pointer;
  margin:5px;
}

img{
  width:220px;
  border-radius:12px;
  margin:10px;
}

.progress{
  height:15px;
  background:rgba(255,255,255,0.3);
  margin:15px;
  border-radius:10px;
}

.progress-bar{
  height:100%;
  background:#ef4444;
  width:0%;
  border-radius:10px;
}

#camera{
  width:200px;
  display:none;
  margin-top:10px;
  border-radius:10px;
}
</style>
</head>

<body>

<div id="mascot">üêØü¶ª</div>

<header>
<h1>ASL Learning Game</h1>
<div class="stats">
XP: <span id="xp">0</span> |
üî• Streak: <span id="streak">0</span>
</div>
<button onclick="toggleMusic()">üéµ Music</button>
<button onclick="startCamera()">üì∑ Camera</button>
</header>

<div class="progress">
<div class="progress-bar" id="progressBar"></div>
</div>

<div class="level-grid" id="levels"></div>

<div class="lesson" id="lessonBox">
<h2 id="lessonTitle"></h2>
<div id="lessonContent"></div>
</div>

<video id="camera" autoplay></video>

<h3>Share Project</h3>
<canvas id="qr"></canvas>

<audio id="music" loop>
<source src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_115b9b6f18.mp3">
</audio>

<script>

let xp = parseInt(localStorage.getItem("xp")) || 0;
let unlocked = parseInt(localStorage.getItem("unlocked")) || 1;
let streak = parseInt(localStorage.getItem("streak")) || 0;

document.getElementById("xp").innerText = xp;
document.getElementById("streak").innerText = streak;

const levels = document.getElementById("levels");

for(let i=1;i<=5;i++){
  let div=document.createElement("div");
  div.className="level";
  if(i>unlocked) div.classList.add("locked");
  div.innerText="Level "+i;
  div.onclick=()=>{ if(i<=unlocked) startLevel(i); };
  levels.appendChild(div);
}

let currentLevel=0;
let step=0;

const alphabetQuiz = [
  {img:"A.jpg", correct:"A", options:["A","B","C"]},
  {img:"B.jpg", correct:"B", options:["D","B","F"]},
  {img:"C.jpg", correct:"C", options:["C","A","E"]},
  {img:"D.jpg", correct:"D", options:["D","G","H"]},
  {img:"E.jpg", correct:"E", options:["E","F","B"]},
  {img:"F.jpg", correct:"F", options:["A","F","C"]}
];

function startLevel(level){
  currentLevel=level;
  step=0;
  document.getElementById("lessonBox").style.display="block";
  showLesson();
}

function showLesson(){

  document.getElementById("lessonTitle").innerText =
  "Level "+currentLevel;

  let content=document.getElementById("lessonContent");

  if(currentLevel===1){
    content.innerHTML=`
      <p>Welcome to Alphabet Practice!</p>
      <p>In Level 2 you will identify ASL letters from images.</p>
      <button onclick="completeLevel()">Start Quiz</button>
    `;
  }

  else if(currentLevel===2){

    let question = alphabetQuiz[step];

    content.innerHTML = `
      <p>What letter is this?</p>
      <img src="${question.img}">
      <div id="quizOptions"></div>
    `;

    let optionsDiv = document.getElementById("quizOptions");

    question.options.forEach(option=>{
      let btn = document.createElement("button");
      btn.innerText = option;
      btn.onclick = function(){
        if(option === question.correct){
          xp += 5;
          document.getElementById("xp").innerText = xp;
          localStorage.setItem("xp",xp);
          step++;
          updateProgress();

          if(step < alphabetQuiz.length){
            showLesson();
          } else {
            completeLevel();
          }

        } else {
          alert("Try Again!");
        }
      };
      optionsDiv.appendChild(btn);
    });
  }

  else{
    content.innerHTML="<p>More levels coming soon!</p>";
  }

  updateProgress();
}

function updateProgress(){
  if(currentLevel===2){
    document.getElementById("progressBar").style.width =
    (step/alphabetQuiz.length)*100+"%";
  } else {
    document.getElementById("progressBar").style.width = "0%";
  }
}

function completeLevel(){
  unlocked++;
  streak++;
  localStorage.setItem("unlocked",unlocked);
  localStorage.setItem("streak",streak);
  alert("Level Complete!");
  setTimeout(()=>location.reload(),1000);
}

function toggleMusic(){
  let music=document.getElementById("music");
  music.paused?music.play():music.pause();
}

function startCamera(){
  let cam=document.getElementById("camera");
  cam.style.display="block";
  navigator.mediaDevices.getUserMedia({video:true})
  .then(stream=>{cam.srcObject=stream;});
}

QRCode.toCanvas(document.getElementById('qr'), window.location.href);

</script>

</body>
</html>
