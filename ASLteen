<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ASL Game</title>

<script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:linear-gradient(135deg,#0ea5e9,#14b8a6);
  color:white;
  text-align:center;
}

header{
  padding:15px;
}

#mascot{
  position:fixed;
  top:10px;
  left:10px;
  font-size:60px;
}

.stats{
  margin-top:5px;
}

.level-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(80px,1fr));
  gap:10px;
  padding:20px;
}

.level{
  background:white;
  color:black;
  padding:10px;
  border-radius:12px;
  cursor:pointer;
}

.locked{
  opacity:0.4;
  cursor:not-allowed;
}

.lesson{
  display:none;
  background:white;
  color:black;
  margin:20px;
  padding:20px;
  border-radius:15px;
}

button{
  padding:10px 15px;
  border:none;
  border-radius:10px;
  background:#ef4444;
  color:white;
  cursor:pointer;
  margin:5px;
}

iframe{
  width:100%;
  height:250px;
  border-radius:12px;
}

.progress{
  height:15px;
  background:rgba(255,255,255,0.3);
  margin:15px;
  border-radius:10px;
}

.progress-bar{
  height:100%;
  background:#ef4444;
  width:0%;
  border-radius:10px;
}
</style>
</head>

<body>

<div id="mascot">üêØü¶ª</div>

<header>
<h1>ASL Game</h1>
<div class="stats">
XP: <span id="xp">0</span> |
üî• Streak: <span id="streak">0</span>
</div>
<button onclick="toggleMusic()">üéµ Music</button>
<button onclick="startCamera()">üì∑ Camera</button>
</header>

<div class="progress">
<div class="progress-bar" id="progressBar"></div>
</div>

<div class="level-grid" id="levels"></div>

<div class="lesson" id="lessonBox">
<h2 id="lessonTitle"></h2>
<div id="lessonContent"></div>
<button onclick="nextLesson()">Next</button>
</div>

<video id="camera" autoplay style="width:200px; display:none;"></video>

<h3>Share QR</h3>
<canvas id="qr"></canvas>

<audio id="music" loop>
<source src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_115b9b6f18.mp3">
</audio>

<script>

let xp = parseInt(localStorage.getItem("xp")) || 0;
let unlocked = parseInt(localStorage.getItem("unlocked")) || 1;
let streak = parseInt(localStorage.getItem("streak")) || 0;

document.getElementById("xp").innerText=xp;
document.getElementById("streak").innerText=streak;

const levels=document.getElementById("levels");

for(let i=1;i<=30;i++){
  let div=document.createElement("div");
  div.className="level";
  if(i>unlocked) div.classList.add("locked");
  div.innerText="Level "+i;
  div.onclick=()=>{ if(i<=unlocked) startLevel(i); };
  levels.appendChild(div);
}

let currentLevel=0;
let step=0;

function startLevel(level){
  currentLevel=level;
  step=0;
  document.getElementById("lessonBox").style.display="block";
  showLesson();
}

function showLesson(){
  document.getElementById("lessonTitle").innerText=
  "Level "+currentLevel+" - Lesson "+(step+1);

  let content=document.getElementById("lessonContent");

  if(currentLevel===1){
    content.innerHTML="<p>Alphabet Practice ‚úã</p>";
  }
  else if(currentLevel===2){
    content.innerHTML="<p>Common Phrases Practice üó£Ô∏è</p>";
  }
  else if(currentLevel===3){
    content.innerHTML="<p>Daily Questions Practice ‚ùì</p>";
  }
  else if(currentLevel===4){
    content.innerHTML=`
      <p>Quiz Time!</p>
      <button onclick="quiz(true)">Answer A</button>
      <button onclick="quiz(false)">Answer B</button>
    `;
  }
  else{
    content.innerHTML="<p>Advanced Practice Mode</p>";
  }

  updateProgress();
}

function quiz(correct){
  if(correct){
    alert("Correct!");
  }else{
    alert("Try Again!");
  }
}

function nextLesson(){
  step++;
  if(step<6){
    showLesson();
  }else{
    xp+=10;
    unlocked++;
    localStorage.setItem("xp",xp);
    localStorage.setItem("unlocked",unlocked);
    launchConfetti();
    setTimeout(()=>location.reload(),1500);
  }
}

function updateProgress(){
  document.getElementById("progressBar").style.width=
  (step/6)*100+"%";
}

function toggleMusic(){
  let music=document.getElementById("music");
  music.paused?music.play():music.pause();
}

function startCamera(){
  let cam=document.getElementById("camera");
  cam.style.display="block";
  navigator.mediaDevices.getUserMedia({video:true})
  .then(stream=>{cam.srcObject=stream;});
}

function launchConfetti(){
  alert("Level Complete!");
}

QRCode.toCanvas(document.getElementById('qr'), window.location.href);

</script>

</body>
</html>
