<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ASL Vision AI</title>

<script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js"></script>

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:linear-gradient(135deg,#0f172a,#1e3a8a);
  color:white;
  text-align:center;
}

#tiger{
  position:fixed;
  top:10px;
  right:15px;
  font-size:55px;
}

h1{ color:#ef4444; }

.level{
  background:#ef4444;
  padding:15px;
  margin:10px;
  border-radius:15px;
  cursor:pointer;
  display:inline-block;
  font-weight:bold;
}

.level:hover{
  background:#3b82f6;
}

video{
  width:360px;
  border-radius:15px;
}

canvas{
  position:absolute;
  left:0;
  top:0;
}

.lesson{
  display:none;
  margin-top:20px;
}

.result{
  font-size:20px;
  margin-top:10px;
}
</style>
</head>

<body>

<div id="tiger">üêØ</div>
<h1>ASL AI Recognition System</h1>

<div>
  <div class="level" onclick="startLevel(1)">Level 1</div>
  <div class="level" onclick="startLevel(2)">Level 2</div>
  <div class="level" onclick="startLevel(3)">Level 3</div>
  <div class="level" onclick="startLevel(4)">Level 4</div>
</div>

<div class="lesson" id="lessonBox">
  <h2 id="lessonTitle"></h2>
  <div id="lessonContent"></div>
</div>

<script>

let currentLetter = "";
const letters = ["A","B","C"];

function startLevel(level){
  document.getElementById("lessonBox").style.display="block";
  document.getElementById("lessonTitle").innerText="Level "+level;

  if(level===1){
    document.getElementById("lessonContent").innerHTML=
    `<iframe width="560" height="315"
    src="https://www.youtube.com/embed/VIDEO_ID_1"
    allowfullscreen></iframe>`;
  }

  if(level===2){
    startCameraAI();
  }

  if(level===3){
    document.getElementById("lessonContent").innerHTML=
    `<iframe width="560" height="315"
    src="https://www.youtube.com/embed/VIDEO_ID_2"
    allowfullscreen></iframe>`;
  }

  if(level===4){
    startCameraAI();
  }
}

function startCameraAI(){

  currentLetter = letters[Math.floor(Math.random()*letters.length)];

  document.getElementById("lessonContent").innerHTML=`
    <p>Sign the letter: <strong>${currentLetter}</strong></p>
    <video id="video" autoplay></video>
    <canvas id="canvas" width="360" height="270"></canvas>
    <div class="result" id="result">Waiting for hand...</div>
  `;

  const video = document.getElementById("video");
  const canvas = document.getElementById("canvas");
  const ctx = canvas.getContext("2d");

  const hands = new Hands({
    locateFile: file =>
      `https://cdn.jsdelivr.net/npm/@mediapipe/hands/${file}`
  });

  hands.setOptions({
    maxNumHands: 1,
    minDetectionConfidence: 0.8,
    minTrackingConfidence: 0.8
  });

  hands.onResults(results => {
    ctx.clearRect(0,0,canvas.width,canvas.height);

    if(results.multiHandLandmarks.length > 0){
      const landmarks = results.multiHandLandmarks[0];

      let detected = classifyHand(landmarks);

      if(detected === currentLetter){
        document.getElementById("result").innerHTML =
        "‚úÖ AI Detected: " + detected + " (Correct!)";
      } else {
        document.getElementById("result").innerHTML =
        "‚ùå AI Detected: " + detected;
      }
    }
  });

  const camera = new Camera(video,{
    onFrame: async () => {
      await hands.send({image: video});
    },
    width:360,
    height:270
  });
  camera.start();
}

function classifyHand(landmarks){

  // Simple rule-based detection

  const thumbTip = landmarks[4];
  const indexTip = landmarks[8];
  const middleTip = landmarks[12];
  const ringTip = landmarks[16];
  const pinkyTip = landmarks[20];
  const wrist = landmarks[0];

  // A = fist (all fingers close to wrist)
  if(
    distance(indexTip,wrist) < 0.15 &&
    distance(middleTip,wrist) < 0.15
  ){
    return "A";
  }

  // B = flat hand (fingers extended upward)
  if(
    indexTip.y < landmarks[6].y &&
    middleTip.y < landmarks[10].y &&
    ringTip.y < landmarks[14].y &&
    pinkyTip.y < landmarks[18].y
  ){
    return "B";
  }

  // C = curved hand (thumb + index far apart)
  if(distance(thumbTip,indexTip) > 0.15){
    return "C";
  }

  return "Unknown";
}

function distance(p1,p2){
  return Math.sqrt(
    Math.pow(p1.x - p2.x,2) +
    Math.pow(p1.y - p2.y,2)
  );
}

</script>

</body>
</html>
