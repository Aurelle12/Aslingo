<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SignQuest</title>
<script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>

<style>
body {
  margin:0;
  font-family:Arial, sans-serif;
  background:#f4f7fb;
  text-align:center;
}
header {
  background:#58cc02;
  color:white;
  padding:20px;
}
button {
  padding:10px 18px;
  border:none;
  border-radius:12px;
  background:#58cc02;
  color:white;
  cursor:pointer;
  margin:5px;
}
.level-grid {
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(90px,1fr));
  gap:10px;
  padding:20px;
}
.level {
  background:white;
  padding:15px;
  border-radius:15px;
  cursor:pointer;
  box-shadow:0 4px 8px rgba(0,0,0,0.1);
}
.locked { opacity:0.4; cursor:not-allowed; }
.lesson-box {
  display:none;
  margin:20px;
  padding:20px;
  background:white;
  border-radius:15px;
}
.progress {
  height:12px;
  background:#ddd;
  margin:10px;
  border-radius:10px;
}
.progress-bar {
  height:100%;
  background:#58cc02;
  width:0%;
  border-radius:10px;
}
iframe {
  width:100%;
  max-width:500px;
  height:280px;
  border-radius:12px;
}
#camera { display:none; margin-top:10px; }
footer { margin-top:20px; padding:20px; font-size:14px; }
</style>
</head>

<body>

<header>
<h1>SignQuest âœ‹</h1>
<p>Master ASL â€“ 30 Levels</p>
<p>XP: <span id="xp">0</span></p>
<button onclick="startApp()">Start Learning</button>
<button onclick="toggleMusic()">ðŸ”Š Toggle Music</button>
</header>

<div class="progress"><div class="progress-bar" id="progressBar"></div></div>

<div class="level-grid" id="levels"></div>

<div class="lesson-box" id="lessonBox">
<h2 id="lessonTitle"></h2>
<iframe id="videoFrame" src="" allowfullscreen></iframe>
<br>
<button onclick="nextLesson()">Next</button>
<button onclick="startCamera()">Camera Mode</button>
<video id="camera" width="200" autoplay></video>
</div>

<h3>Scan QR to open this site</h3>
<canvas id="qr"></canvas>

<footer>
SignQuest â€“ ASL Learning Platform
</footer>

<audio id="bgMusic" loop>
<source src="https://cdn.pixabay.com/audio/2022/03/15/audio_115b9bfa52.mp3" type="audio/mpeg">
</audio>

<audio id="clickSound">
<source src="https://cdn.pixabay.com/audio/2022/03/10/audio_c8c8a73467.mp3" type="audio/mpeg">
</audio>

<script>
let xp = parseInt(localStorage.getItem("xp")||0);
let unlocked = parseInt(localStorage.getItem("unlocked")||1);
document.getElementById("xp").innerText=xp;

const alphabetVideos=[
"https://www.youtube.com/embed/3QzDkE9lY5A",
"https://www.youtube.com/embed/3QzDkE9lY5A?start=30",
"https://www.youtube.com/embed/3QzDkE9lY5A?start=60",
"https://www.youtube.com/embed/3QzDkE9lY5A?start=90",
"https://www.youtube.com/embed/3QzDkE9lY5A?start=120",
"https://www.youtube.com/embed/3QzDkE9lY5A?start=150"
];

const phraseVideos=[
"https://www.youtube.com/embed/k9c1vJXn6u4",
"https://www.youtube.com/embed/k9c1vJXn6u4?start=40",
"https://www.youtube.com/embed/k9c1vJXn6u4?start=80",
"https://www.youtube.com/embed/k9c1vJXn6u4?start=120",
"https://www.youtube.com/embed/k9c1vJXn6u4?start=160",
"https://www.youtube.com/embed/k9c1vJXn6u4?start=200"
];

const questionVideos=[
"https://www.youtube.com/embed/fkMg_X9lHMc",
"https://www.youtube.com/embed/fkMg_X9lHMc?start=40",
"https://www.youtube.com/embed/fkMg_X9lHMc?start=80",
"https://www.youtube.com/embed/fkMg_X9lHMc?start=120",
"https://www.youtube.com/embed/fkMg_X9lHMc?start=160",
"https://www.youtube.com/embed/fkMg_X9lHMc?start=200"
];

const levelsDiv=document.getElementById("levels");
for(let i=1;i<=30;i++){
  const div=document.createElement("div");
  div.className="level";
  if(i>unlocked) div.classList.add("locked");
  div.innerText="L"+i;
  div.onclick=()=>{ if(i<=unlocked) startLevel(i); };
  levelsDiv.appendChild(div);
}

let currentLevel=0;
let lessonStep=0;

function startApp(){
  document.getElementById("bgMusic").play();
}

function toggleMusic(){
  const music=document.getElementById("bgMusic");
  music.paused?music.play():music.pause();
}

function startLevel(level){
  document.getElementById("clickSound").play();
  currentLevel=level;
  lessonStep=0;
  document.getElementById("lessonBox").style.display="block";
  loadVideo();
}

function loadVideo(){
  let videoList;
  if(currentLevel==1) videoList=alphabetVideos;
  else if(currentLevel==2) videoList=phraseVideos;
  else if(currentLevel==3) videoList=questionVideos;
  else videoList=alphabetVideos;

  document.getElementById("lessonTitle").innerText=
    "Level "+currentLevel+" - Lesson "+(lessonStep+1);

  document.getElementById("videoFrame").src=videoList[lessonStep];
  updateProgress();
}

function nextLesson(){
  document.getElementById("clickSound").play();
  lessonStep++;
  if(lessonStep<6){
    loadVideo();
  } else {
    xp+=10;
    unlocked++;
    localStorage.setItem("xp",xp);
    localStorage.setItem("unlocked",unlocked);
    alert("Level Complete! +10 XP ðŸŽ‰");
    location.reload();
  }
}

function updateProgress(){
  document.getElementById("progressBar").style.width=
    ((lessonStep)/6)*100+"%";
}

function startCamera(){
  const video=document.getElementById("camera");
  video.style.display="block";
  navigator.mediaDevices.getUserMedia({video:true})
    .then(stream=>video.srcObject=stream);
}

QRCode.toCanvas(document.getElementById('qr'), window.location.href);
</script>

</body>
</html>
